(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var TStringBuilder = (function () {
    function TStringBuilder() {
        var _this = this;
        this._buffer = [];
        this.append = function (line) {
            console.log(line);
            _this._buffer.push(line);
            return _this;
        };
        this.cr = function () {
            _this.append("\n");
            return _this;
        };
        this.toString = function () {
            return _this._buffer.join("");
        };
    }
    return TStringBuilder;
})();
exports.TStringBuilder = TStringBuilder;
function html_encode(val) {
    // TODO
    return val;
}
function quote_af(val) {
    return '"' + val + '"';
}
function fmt_attr(attr) {
    return attr.name + "=" + quote_af(html_encode(attr.value));
}
function fmt_attrs(sb, attrs) {
    var first = true;
    attrs.forEach(function (attr) {
        if (!first) {
            sb.append(" ");
        }
        else {
            first = false;
        }
        // <a href="$menuItem.href$" id="$menuItem.id$">$menuItem.caption$</a>
        sb.append(fmt_attr(attr));
    });
}
// def fill_sb_with_tag (sb, tag, attrs, arr_fn_on_inner, cbData, with_end_tag=True):
function fill_sb_with_tag(sb, tag, o) {
    o.with_end_tag = o.with_end_tag || true;
    sb.append("<" + tag);
    //    if attrs is None:
    if (!o.attrs) {
        sb.append(">").cr();
    }
    else {
        sb.append(" ");
        fmt_attrs(sb, o.attrs);
        sb.append(">").cr();
    }
    //    for fn_on_inner in arr_fn_on_inner:
    if ((o.arr_fn_on_inner)) {
        o.arr_fn_on_inner.forEach(function (fn) {
            if (fn) {
                fn(sb, o.cbData);
            }
        });
    }
    //    if with_end_tag:
    //        sb.append("<%s/>" % tag)
    if (o.innerHtml) {
        sb.append(o.innerHtml).cr();
    }
    if (o.with_end_tag) {
        sb.append("</" + tag + ">").cr();
    }
}
exports.fill_sb_with_tag = fill_sb_with_tag;
function create_attr_class(class_name) {
    return { name: "class", value: class_name };
}
exports.create_attr_class = create_attr_class;
function create_attr_id(html_id) {
    return { name: "id", value: html_id };
}
exports.create_attr_id = create_attr_id;
function create_attr(name, value) {
    return { name: name, value: value };
}
exports.create_attr = create_attr;
function create_attrs(arr) {
    var i = 0, l = arr.length;
    var ret = [];
    for (i = 0; i < l; i += 2) {
        ret.push(create_attr(arr[i], arr[i + 1]));
    }
    return ret;
}
exports.create_attrs = create_attrs;
//def create_css_include (sb, attrs,href):
function create_css_include(sb, attrs, href) {
    // <link type="text/css" rel="stylesheet" href="du_export.css">
    var attrs = (create_attrs([
        "type", "text/css",
        "rel", "stylesheet",
        "href", href]));
    //    print attrs
    fill_sb_with_tag(sb, "link", {
        attr: attrs,
        with_end_tag: false
    });
}
},{}],2:[function(require,module,exports){
function exportNsObj(libName, objName, obj) {
    var dkm_libName = "dkm_" + libName;
    if (typeof window[dkm_libName] != "Object") {
        window[dkm_libName] = {};
    }
    if (typeof window[dkm_libName][objName] != "Object") {
        window[dkm_libName][objName] = obj;
    }
}
exports.exportNsObj = exportNsObj;
},{}],3:[function(require,module,exports){
var hbuild = require("./hbuild");
var nameSpaceExport = require("dkmlib/generic/nameSpaceExport");
function buildSelectOptsAttrs(opts) {
    var attrs = [];
    var keys = Object.keys(opts);
    keys.forEach(function (key) {
        if (typeof opts[key] !== "undefined") {
            attrs.push({
                name: key,
                value: opts[key]
            });
        }
    });
    return attrs;
}
function createSelectOpts(opts) {
    hbuild.fill_sb_with_tag(opts.sb, "option", {
        attrs: buildSelectOptsAttrs(opts.attrs),
        innerHtml: opts.displayField
    });
}
exports.createSelectOpts = createSelectOpts;
function createSelect(opts) {
    function buildSelopts(sb, cbData) {
        cbData.forEach(function (row) {
            createSelectOpts({
                attrs: {
                    value: row[opts.valueField],
                    selected: opts.selectedVal === row[opts.valueField]
                },
                displayField: row[opts.displayField],
                sb: sb
            });
        });
    }
    function buildFirstRow(sb, dbData) {
        createSelectOpts({
            attrs: {
                value: opts.firstRows.value,
                selected: opts.displayField == opts.selectedVal
            },
            displayField: opts.firstRows.caption,
            sb: sb
        });
    }
    hbuild.fill_sb_with_tag(opts.sb, "select", {
        attrs: opts.attrs,
        arr_fn_on_inner: [buildSelopts],
        cbData: opts.data
    });
}
exports.createSelect = createSelect;
nameSpaceExport.exportNsObj("dkmlib", "selectBuild", {
    createSelect: createSelect
});
},{"./hbuild":1,"dkmlib/generic/nameSpaceExport":2}],4:[function(require,module,exports){
/// <reference path="../../generic/hbuild.ts" />
/// <reference path="../../external/jquery.d.ts" />
var hbuild = require("dkmlib/generic/hbuild");
function test_menu() {
    var j_content = $("#content");
    var sb = new hbuild.TStringBuilder();
    function a(sb, cbData) {
        //<a href="$menuItem.href$" id= "$menuItem.id$" > $menuItem.caption$ < /a>
        var hrefAttrs = hbuild.create_attrs(["href", cbData.href, "id", cbData.id]);
        hbuild.fill_sb_with_tag(sb, "a", {
            attrs: hrefAttrs,
            innerHtml: cbData.caption
        });
    }
    function lis(sb, cbData) {
        var i = 0;
        for (i = 0; i < 10; i++) {
            hbuild.fill_sb_with_tag(sb, "li", {
                cbData: {
                    href: "#",
                    id: "li" + i,
                    caption: "Item " + (i + 1)
                },
                arr_fn_on_inner: [a]
            });
        }
    }
    hbuild.fill_sb_with_tag(sb, "ul", {
        arr_fn_on_inner: [lis]
    });
    var html = sb.toString();
    console.log(html);
    $("#zeige_html").val(html);
    window.document.getElementById("content").innerHTML = html;
}
function sanitizeHTML(s) {
    var d = document.createElement('div');
    d.appendChild(document.createTextNode(s));
    return d.innerHTML;
}
function start() {
    $(document).ready(function () {
        test_menu();
    });
}
exports.start = start;
},{"dkmlib/generic/hbuild":1}],5:[function(require,module,exports){
var hbuild_test = require("./hbuild_test");
var selectBuild = require("./selectBuild_test");
hbuild_test.start();
selectBuild.start();
},{"./hbuild_test":4,"./selectBuild_test":6}],6:[function(require,module,exports){
/**
 * Created by michael on 04.08.2015.
 */
/// <reference path="../../external/jquery.d.ts" />
var selectBuild = require("dkmlib/generic/selectBuild");
var hbuild = require("dkmlib/generic/hbuild");
function cbxTest() {
    var data = [
        { nr: "1", mname: "Michael" },
        { nr: "2", mname: "Monika" },
        { nr: "3", mname: "Anna" },
    ];
    var sb = new hbuild.TStringBuilder();
    selectBuild.createSelect({
        data: data,
        valueField: "nr",
        displayField: "mname",
        /* firstRows?: ISelectOpt;
     attrs?: hbuild.IAttribute[];*/
        selectedVal: "1",
        sb: sb
    });
    var html = sb.toString();
    window.document.getElementById("selectResult").innerHTML = html;
}
function start() {
    $(document).ready(function () {
        cbxTest();
    });
}
exports.start = start;
},{"dkmlib/generic/hbuild":1,"dkmlib/generic/selectBuild":3}]},{},[5])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJka21saWIvZ2VuZXJpYy9oYnVpbGQudHMiLCJka21saWIvZ2VuZXJpYy9uYW1lU3BhY2VFeHBvcnQudHMiLCJka21saWIvZ2VuZXJpYy9zZWxlY3RCdWlsZC50cyIsImRrbWxpYi90ZXN0L2dlbmVyaWMvaGJ1aWxkX3Rlc3QudHMiLCJka21saWIvdGVzdC9nZW5lcmljL2luZGV4LnRzIiwiZGttbGliL3Rlc3QvZ2VuZXJpYy9zZWxlY3RCdWlsZF90ZXN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDTUE7SUFBQTtRQUFBLGlCQW1CQztRQWxCRyxZQUFPLEdBQWEsRUFBRSxDQUFDO1FBR3ZCLFdBQU0sR0FBc0MsVUFBQyxJQUFJO1lBQzdDLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDbEIsS0FBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDeEIsTUFBTSxDQUFDLEtBQUksQ0FBQztRQUNoQixDQUFDLENBQUE7UUFFRCxPQUFFLEdBQXVCO1lBQ3JCLEtBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDbEIsTUFBTSxDQUFDLEtBQUksQ0FBQztRQUNoQixDQUFDLENBQUE7UUFFRCxhQUFRLEdBQWM7WUFDbEIsTUFBTSxDQUFDLEtBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ2pDLENBQUMsQ0FBQTtJQUVMLENBQUM7SUFBRCxxQkFBQztBQUFELENBbkJBLEFBbUJDLElBQUE7QUFuQlksc0JBQWMsaUJBbUIxQixDQUFBO0FBRUQscUJBQXFCLEdBQVc7SUFDNUIsQUFDQSxPQURPO0lBQ1AsTUFBTSxDQUFDLEdBQUcsQ0FBQTtBQUNkLENBQUM7QUFHRCxrQkFBa0IsR0FBVztJQUN6QixNQUFNLENBQUMsR0FBRyxHQUFH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QUN6QixFQUFDLEVBQUUsRUFBQyxHQUFHLEVBQUUsS0FBSyxFQUFDLFFBQVEsRUFBQztRQUN4QixFQUFDLEVBQUUsRUFBQyxHQUFHLEVBQUUsS0FBSyxFQUFDLE1BQU0sRUFBQztLQUN6QixDQUFDO0lBRUYsSUFBSSxFQUFFLEdBQXlCLElBQUksTUFBTSxDQUFDLGNBQWMsRUFBRSxDQUFDO0lBRTNELFdBQVcsQ0FBQyxZQUFZLENBQUM7UUFDckIsSUFBSSxFQUFFLElBQUk7UUFDVixVQUFVLEVBQUUsSUFBSTtRQUNoQixZQUFZLEVBQUUsT0FBTztRQUN0QixBQUVDO21DQUQwQjtRQUMxQixXQUFXLEVBQUUsR0FBRztRQUNoQixFQUFFLEVBQUUsRUFBRTtLQUNULENBQUMsQ0FBQztJQUNILElBQUksSUFBSSxHQUFHLEVBQUUsQ0FBQyxRQUFRLEVBQUUsQ0FBQztJQUN6QixNQUFNLENBQUMsUUFBUSxDQUFDLGNBQWMsQ0FBQyxjQUFjLENBQUMsQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDO0FBQ3BFLENBQUM7QUFFRDtJQUNJLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxLQUFLLENBQUM7UUFDZixPQUFPLEVBQUUsQ0FBQztJQUNiLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQztBQUplLGFBQUssUUFJcEIsQ0FBQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCLvu79leHBvcnQgaW50ZXJmYWNlIElTdHJpbmdCdWlsZGVyIHtcclxuICAgIGFwcGVuZDogKGxpbmU6IHN0cmluZykgPT4gSVN0cmluZ0J1aWxkZXI7XHJcbiAgICBjcjogKCkgPT4gSVN0cmluZ0J1aWxkZXI7XHJcbiAgICB0b1N0cmluZzooKT0+IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFRTdHJpbmdCdWlsZGVyIGltcGxlbWVudHMgSVN0cmluZ0J1aWxkZXIge1xyXG4gICAgX2J1ZmZlcjogc3RyaW5nW10gPSBbXTtcclxuXHJcblxyXG4gICAgYXBwZW5kOiAoKGxpbmU6IHN0cmluZyk9PiBJU3RyaW5nQnVpbGRlcikgPSAobGluZSk9PiAge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGxpbmUpO1xyXG4gICAgICAgIHRoaXMuX2J1ZmZlci5wdXNoKGxpbmUpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIGNyOigpPT4gSVN0cmluZ0J1aWxkZXIgPSAoKSA9PiAge1xyXG4gICAgICAgIHRoaXMuYXBwZW5kKFwiXFxuXCIpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIHRvU3RyaW5nOigpPT5zdHJpbmcgPSAoKT0+ICB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2J1ZmZlci5qb2luKFwiXCIpO1xyXG4gICAgfVxyXG5cclxufVxyXG5cclxuZnVuY3Rpb24gaHRtbF9lbmNvZGUodmFsOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgLy8gVE9ET1xyXG4gICAgcmV0dXJuIHZhbFxyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gcXVvdGVfYWYodmFsOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuICdcIicgKyB2YWwgKyAnXCInXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSUF0dHJpYnV0ZSB7XHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICB2YWx1ZTogc3RyaW5nO1xyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gZm10X2F0dHIoYXR0cjogSUF0dHJpYnV0ZSkge1xyXG4gICAgcmV0dXJuIGF0dHIubmFtZSArIFwiPVwiICsgcXVvdGVfYWYoaHRtbF9lbmNvZGUoYXR0ci52YWx1ZSkpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBmbXRfYXR0cnMoc2I6IElTdHJpbmdCdWlsZGVyLCBhdHRyczogSUF0dHJpYnV0ZVtdKTogdm9pZCB7XHJcbiAgICB2YXIgZmlyc3QgPSB0cnVlO1xyXG4gICAgYXR0cnMuZm9yRWFjaCgoYXR0cjogSUF0dHJpYnV0ZSkgPT4ge1xyXG4gICAgICAgIGlmICghZmlyc3QpIHtcclxuICAgICAgICAgICAgc2IuYXBwZW5kKFwiIFwiKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBmaXJzdCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuLy8gPGEgaHJlZj1cIiRtZW51SXRlbS5ocmVmJFwiIGlkPVwiJG1lbnVJdGVtLmlkJFwiPiRtZW51SXRlbS5jYXB0aW9uJDwvYT5cclxuICAgICAgICBzYi5hcHBlbmQoZm10X2F0dHIoYXR0cikpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElmbk9uSW5uZXIgeyAoc2I6IElTdHJpbmdCdWlsZGVyLCBjYkRhdGE6IGFueSk6dm9pZH1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSUZpbGxfc2Jfd2l0aF90YWdfb3B0cyB7XHJcbiAgICBhdHRycz86IElBdHRyaWJ1dGVbXTtcclxuICAgIGFycl9mbl9vbl9pbm5lcj86IElmbk9uSW5uZXJbXTtcclxuICAgIGNiRGF0YT86IGFueTtcclxuICAgIHdpdGhfZW5kX3RhZz86IGJvb2xlYW47XHJcbiAgICBpbm5lckh0bWw/OiBzdHJpbmc7XHJcbn1cclxuXHJcbi8vIGRlZiBmaWxsX3NiX3dpdGhfdGFnIChzYiwgdGFnLCBhdHRycywgYXJyX2ZuX29uX2lubmVyLCBjYkRhdGEsIHdpdGhfZW5kX3RhZz1UcnVlKTpcclxuZXhwb3J0IGZ1bmN0aW9uIGZpbGxfc2Jfd2l0aF90YWcoc2I6SVN0cmluZ0J1aWxkZXIsIHRhZzpzdHJpbmcsIG86SUZpbGxfc2Jfd2l0aF90YWdfb3B0cyk6IHZvaWQge1xyXG5cclxuICAgIG8ud2l0aF9lbmRfdGFnID0gby53aXRoX2VuZF90YWcgfHwgdHJ1ZTtcclxuICAgIHNiLmFwcGVuZChcIjxcIiArIHRhZyk7XHJcbi8vICAgIGlmIGF0dHJzIGlzIE5vbmU6XHJcbiAgICBpZiAoIW8uYXR0cnMpIHtcclxuICAgICAgICBzYi5hcHBlbmQoXCI+XCIpLmNyKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHNiLmFwcGVuZChcIiBcIik7XHJcbiAgICAgICAgZm10X2F0dHJzKHNiLCBvLmF0dHJzKTtcclxuICAgICAgICBzYi5hcHBlbmQoXCI+XCIpLmNyKCk7XHJcbiAgICB9XHJcbi8vICAgIGZvciBmbl9vbl9pbm5lciBpbiBhcnJfZm5fb25faW5uZXI6XHJcbiAgICBpZiAoKG8uYXJyX2ZuX29uX2lubmVyKSApIHtcclxuICAgICAgICBvLmFycl9mbl9vbl9pbm5lci5mb3JFYWNoKChmbikgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZm4pIHtcclxuICAgICAgICAgICAgICAgIGZuKHNiLCBvLmNiRGF0YSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuLy8gICAgaWYgd2l0aF9lbmRfdGFnOlxyXG4vLyAgICAgICAgc2IuYXBwZW5kKFwiPCVzLz5cIiAlIHRhZylcclxuICAgIGlmIChvLmlubmVySHRtbCkge1xyXG4gICAgICAgIHNiLmFwcGVuZChvLmlubmVySHRtbCkuY3IoKTtcclxuICAgIH1cclxuICAgIGlmIChvLndpdGhfZW5kX3RhZykge1xyXG4gICAgICAgIHNiLmFwcGVuZChcIjwvXCIgKyB0YWcgKyBcIj5cIikuY3IoKTtcclxuICAgIH1cclxufVxyXG5cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlX2F0dHJfY2xhc3MoY2xhc3NfbmFtZTogc3RyaW5nKTogSUF0dHJpYnV0ZSB7XHJcbiAgICByZXR1cm4geyBuYW1lOlwiY2xhc3NcIiwgdmFsdWU6Y2xhc3NfbmFtZSB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlX2F0dHJfaWQoaHRtbF9pZDogc3RyaW5nKTogSUF0dHJpYnV0ZSB7XHJcbiAgICByZXR1cm4geyBuYW1lOiBcImlkXCIsIHZhbHVlOiBodG1sX2lkfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZV9hdHRyKG5hbWU6c3RyaW5nLCB2YWx1ZTpzdHJpbmcpOiBJQXR0cmlidXRlIHtcclxuICAgIHJldHVybiB7IG5hbWU6IG5hbWUsIHZhbHVlOiB2YWx1ZSB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlX2F0dHJzKGFycjogc3RyaW5nW10pOklBdHRyaWJ1dGVbXSB7XHJcbiAgICB2YXIgaSA9IDAsIGwgPSBhcnIubGVuZ3RoO1xyXG4gICAgdmFyIHJldDogSUF0dHJpYnV0ZVtdID0gW107XHJcbiAgICBmb3IgKGkgPSAwOyBpIDwgbDsgaSArPSAyKSB7XHJcbiAgICAgICAgcmV0LnB1c2goY3JlYXRlX2F0dHIoYXJyW2ldLCBhcnJbaSArIDFdKSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmV0O1xyXG59XHJcblxyXG5cclxuLy9kZWYgY3JlYXRlX2Nzc19pbmNsdWRlIChzYiwgYXR0cnMsaHJlZik6XHJcbmZ1bmN0aW9uIGNyZWF0ZV9jc3NfaW5jbHVkZShzYjogSVN0cmluZ0J1aWxkZXIsIGF0dHJzOiBJQXR0cmlidXRlW10sIGhyZWY6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgLy8gPGxpbmsgdHlwZT1cInRleHQvY3NzXCIgcmVsPVwic3R5bGVzaGVldFwiIGhyZWY9XCJkdV9leHBvcnQuY3NzXCI+XHJcbiAgICB2YXIgYXR0cnMgPSAoY3JlYXRlX2F0dHJzKFtcclxuICAgICAgICBcInR5cGVcIiwgXCJ0ZXh0L2Nzc1wiLFxyXG4gICAgICAgIFwicmVsXCIsIFwic3R5bGVzaGVldFwiLFxyXG4gICAgICAgIFwiaHJlZlwiLCBocmVmXSkpO1xyXG4gICAgLy8gICAgcHJpbnQgYXR0cnNcclxuICAgIGZpbGxfc2Jfd2l0aF90YWcoc2IsIFwibGlua1wiLCB7XHJcbiAgICAgICAgYXR0cjogYXR0cnMsXHJcbiAgICAgICAgd2l0aF9lbmRfdGFnOmZhbHNlXHJcbiAgICB9KTtcclxuXHJcblxyXG59XHJcblxyXG5cclxuXHJcbiIsIu+7v2V4cG9ydCBmdW5jdGlvbiBleHBvcnROc09iaihsaWJOYW1lOiBzdHJpbmcsIG9iak5hbWU6IHN0cmluZywgb2JqOiBhbnkpIHtcclxuICAgIHZhciBka21fbGliTmFtZSA9IFwiZGttX1wiICsgbGliTmFtZTtcclxuXHJcbiAgICBpZiAodHlwZW9mIHdpbmRvd1tka21fbGliTmFtZV0gIT0gXCJPYmplY3RcIikge1xyXG4gICAgICAgIHdpbmRvd1tka21fbGliTmFtZV0gPSB7fTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodHlwZW9mIHdpbmRvd1tka21fbGliTmFtZV1bb2JqTmFtZV0gIT0gXCJPYmplY3RcIikge1xyXG4gICAgICAgIHdpbmRvd1tka21fbGliTmFtZV1bb2JqTmFtZV0gPSBvYmo7XHJcbiAgICB9XHJcbn0gIiwi77u/aW1wb3J0IGhidWlsZCA9IHJlcXVpcmUoXCIuL2hidWlsZFwiKTtcclxuaW1wb3J0IG5hbWVTcGFjZUV4cG9ydCA9IHJlcXVpcmUoXCJka21saWIvZ2VuZXJpYy9uYW1lU3BhY2VFeHBvcnRcIik7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElTZWxlY3RPcHQge1xyXG4gICAgdmFsdWU6IHN0cmluZztcclxuICAgIGNhcHRpb246IHN0cmluZztcclxufVxyXG5cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSVNlbGVjdE9wdEF0dHJzIHtcclxuICAgIGRpc2FibGVkPzogYm9vbGVhbjsvL2Rpc2FibGVkIFx0ZGlzYWJsZWQgXHRTcGVjaWZpZXMgdGhhdCBhbiBvcHRpb24gc2hvdWxkIGJlIGRpc2FibGVkXHJcbiAgICBsYWJlbD86IHN0cmluZzsvL2xhYmVsIFx0dGV4dCBcdFNwZWNpZmllcyBhIHNob3J0ZXIgbGFiZWwgZm9yIGFuIG9wdGlvblxyXG4gICAgc2VsZWN0ZWQ/OiBib29sZWFuOy8vc2VsZWN0ZWQgXHRzZWxlY3RlZCBcdFNwZWNpZmllcyB0aGF0IGFuIG9wdGlvbiBzaG91bGQgYmUgcHJlLSBzZWxlY3RlZCB3aGVuIHRoZSBwYWdlIGxvYWRzXHJcbiAgICB2YWx1ZTogc3RyaW5nOy8vdmFsdWVcclxufVxyXG5cclxuZnVuY3Rpb24gYnVpbGRTZWxlY3RPcHRzQXR0cnMob3B0czogSVNlbGVjdE9wdEF0dHJzKTogaGJ1aWxkLklBdHRyaWJ1dGVbXXtcclxuICAgIHZhciBhdHRyczogaGJ1aWxkLklBdHRyaWJ1dGVbXSA9IFtdO1xyXG4gICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvcHRzKTtcclxuICAgIGtleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBvcHRzW2tleV0gIT09IFwidW5kZWZpbmVkXCIpIHtcclxuICAgICAgICAgICAgYXR0cnMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBrZXksXHJcbiAgICAgICAgICAgICAgICB2YWx1ZTogb3B0c1trZXldXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGF0dHJzO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElDcmVhdGVTZWxlY3RPcHRzT3B0aW9ucyB7XHJcbiAgICBkaXNwbGF5RmllbGQ6IHN0cmluZztcclxuICAgIGF0dHJzOiBJU2VsZWN0T3B0QXR0cnM7XHJcbiAgICBzYjogaGJ1aWxkLlRTdHJpbmdCdWlsZGVyO1xyXG59XHJcblxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVTZWxlY3RPcHRzKG9wdHM6IElDcmVhdGVTZWxlY3RPcHRzT3B0aW9ucyk6IHZvaWQge1xyXG4gICAgaGJ1aWxkLmZpbGxfc2Jfd2l0aF90YWcob3B0cy5zYiwgXCJvcHRpb25cIiwge1xyXG4gICAgICAgIGF0dHJzOiBidWlsZFNlbGVjdE9wdHNBdHRycyhvcHRzLmF0dHJzKSxcclxuICAgICAgICBpbm5lckh0bWwgOiBvcHRzLmRpc3BsYXlGaWVsZFxyXG4gICAgfSk7XHJcblxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElDcmVhdGVTZWxlY3RPcHRpb25zIHtcclxuICAgIGRhdGE6IGFueVtdO1xyXG4gICAgdmFsdWVGaWVsZDogc3RyaW5nO1xyXG4gICAgZGlzcGxheUZpZWxkOiBzdHJpbmc7XHJcbiAgICBmaXJzdFJvd3M/OiBJU2VsZWN0T3B0O1xyXG4gICAgYXR0cnM/OiBoYnVpbGQuSUF0dHJpYnV0ZVtdO1xyXG4gICAgc2VsZWN0ZWRWYWw6IHN0cmluZztcclxuICAgIHNiOiBoYnVpbGQuVFN0cmluZ0J1aWxkZXI7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU2VsZWN0KG9wdHM6IElDcmVhdGVTZWxlY3RPcHRpb25zKTogdm9pZCB7XHJcblxyXG4gICAgZnVuY3Rpb24gYnVpbGRTZWxvcHRzKHNiLCBjYkRhdGEpIHtcclxuICAgICAgICBjYkRhdGEuZm9yRWFjaChmdW5jdGlvbiAocm93KSB7XHJcbiAgICAgICAgICAgIGNyZWF0ZVNlbGVjdE9wdHMoe1xyXG4gICAgICAgICAgICAgICAgYXR0cnM6IHtcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogcm93W29wdHMudmFsdWVGaWVsZF0sXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IG9wdHMuc2VsZWN0ZWRWYWwgPT09IHJvd1tvcHRzLnZhbHVlRmllbGRdXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZGlzcGxheUZpZWxkOiByb3dbb3B0cy5kaXNwbGF5RmllbGRdLFxyXG4gICAgICAgICAgICAgICAgc2I6IHNiXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGJ1aWxkRmlyc3RSb3coc2IsIGRiRGF0YSkge1xyXG4gICAgICAgIGNyZWF0ZVNlbGVjdE9wdHMoe1xyXG4gICAgICAgICAgICBhdHRyczoge1xyXG4gICAgICAgICAgICAgICAgdmFsdWU6IG9wdHMuZmlyc3RSb3dzLnZhbHVlLFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IG9wdHMuZGlzcGxheUZpZWxkID09IG9wdHMuc2VsZWN0ZWRWYWxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZGlzcGxheUZpZWxkOiBvcHRzLmZpcnN0Um93cy5jYXB0aW9uLFxyXG4gICAgICAgICAgICBzYjpzYlxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGhidWlsZC5maWxsX3NiX3dpdGhfdGFnKG9wdHMuc2IsIFwic2VsZWN0XCIsIHtcclxuICAgICAgICBhdHRyczpvcHRzLmF0dHJzLFxyXG4gICAgICAgIGFycl9mbl9vbl9pbm5lcjogW2J1aWxkU2Vsb3B0c10sXHJcbiAgICAgICAgY2JEYXRhOm9wdHMuZGF0YVxyXG4gICAgfSk7XHJcblxyXG59XHJcblxyXG5cclxubmFtZVNwYWNlRXhwb3J0LmV4cG9ydE5zT2JqKFwiZGttbGliXCIsIFwic2VsZWN0QnVpbGRcIiwge1xyXG4gICAgY3JlYXRlU2VsZWN0OiBjcmVhdGVTZWxlY3RcclxufSk7XHJcblxyXG5cclxuICIsIu+7vy8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi9nZW5lcmljL2hidWlsZC50c1wiIC8+XHJcbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi9leHRlcm5hbC9qcXVlcnkuZC50c1wiIC8+XHJcblxyXG5pbXBvcnQgaGJ1aWxkID0gcmVxdWlyZShcImRrbWxpYi9nZW5lcmljL2hidWlsZFwiKTtcclxuXHJcbmZ1bmN0aW9uIHRlc3RfbWVudSgpIHtcclxuICAgIHZhciBqX2NvbnRlbnQgPSAkKFwiI2NvbnRlbnRcIik7XHJcblxyXG4gICAgdmFyIHNiOiBoYnVpbGQuVFN0cmluZ0J1aWxkZXIgPSBuZXcgaGJ1aWxkLlRTdHJpbmdCdWlsZGVyKCk7XHJcblxyXG5cclxuICAgIGZ1bmN0aW9uIGEoc2IsIGNiRGF0YSkge1xyXG4gICAgICAgIC8vPGEgaHJlZj1cIiRtZW51SXRlbS5ocmVmJFwiIGlkPSBcIiRtZW51SXRlbS5pZCRcIiA+ICRtZW51SXRlbS5jYXB0aW9uJCA8IC9hPlxyXG4gICAgICAgIHZhciBocmVmQXR0cnM6IGhidWlsZC5JQXR0cmlidXRlW10gPVxyXG4gICAgICAgICAgICBoYnVpbGQuY3JlYXRlX2F0dHJzKFtcImhyZWZcIiwgY2JEYXRhLmhyZWYsIFwiaWRcIiwgY2JEYXRhLmlkXSk7XHJcblxyXG4gICAgICAgIGhidWlsZC5maWxsX3NiX3dpdGhfdGFnKHNiLCBcImFcIiwge1xyXG4gICAgICAgICAgICBhdHRyczogaHJlZkF0dHJzLFxyXG4gICAgICAgICAgICBpbm5lckh0bWw6IGNiRGF0YS5jYXB0aW9uXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGxpcyhzYiwgY2JEYXRhKSB7XHJcblxyXG4gICAgICAgIHZhciBpID0gMDtcclxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgMTA7IGkrKykge1xyXG4gICAgICAgICAgICBoYnVpbGQuZmlsbF9zYl93aXRoX3RhZyhzYiwgXCJsaVwiLCB7XHJcbiAgICAgICAgICAgICAgICBjYkRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICBocmVmOiBcIiNcIixcclxuICAgICAgICAgICAgICAgICAgICBpZDogXCJsaVwiICsgaSxcclxuICAgICAgICAgICAgICAgICAgICBjYXB0aW9uOiBcIkl0ZW0gXCIgKyAoaSArIDEpXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgYXJyX2ZuX29uX2lubmVyOiBbYV1cclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGhidWlsZC5maWxsX3NiX3dpdGhfdGFnKHNiLCBcInVsXCIsIHtcclxuICAgICAgICBhcnJfZm5fb25faW5uZXI6IFtsaXNdXHJcbiAgICB9KTtcclxuXHJcbiAgICB2YXIgaHRtbCA9IHNiLnRvU3RyaW5nKCk7XHJcblxyXG4gICAgY29uc29sZS5sb2coaHRtbCk7XHJcbiAgICAkKFwiI3plaWdlX2h0bWxcIikudmFsKGh0bWwpO1xyXG4gICAgd2luZG93LmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29udGVudFwiKS5pbm5lckhUTUwgPSBodG1sO1xyXG5cclxufVxyXG5cclxuZnVuY3Rpb24gc2FuaXRpemVIVE1MKHMpIHtcclxuICAgIHZhciBkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBkLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHMpKTtcclxuICAgIHJldHVybiBkLmlubmVySFRNTDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHN0YXJ0KCkge1xyXG4gICAgJChkb2N1bWVudCkucmVhZHkoKCk9PiB7XHJcbiAgICAgICAgdGVzdF9tZW51KCk7XHJcbiAgICB9KTtcclxufVxyXG4gIiwi77u/aW1wb3J0IGhidWlsZF90ZXN0ID0gcmVxdWlyZShcIi4vaGJ1aWxkX3Rlc3RcIik7XG5pbXBvcnQgc2VsZWN0QnVpbGQgPSByZXF1aXJlKFwiLi9zZWxlY3RCdWlsZF90ZXN0XCIpO1xuXG5oYnVpbGRfdGVzdC5zdGFydCgpO1xuc2VsZWN0QnVpbGQuc3RhcnQoKTtcbiIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IG1pY2hhZWwgb24gMDQuMDguMjAxNS5cclxuICovXHJcbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi9leHRlcm5hbC9qcXVlcnkuZC50c1wiIC8+XHJcbmltcG9ydCBzZWxlY3RCdWlsZCA9IHJlcXVpcmUoXCJka21saWIvZ2VuZXJpYy9zZWxlY3RCdWlsZFwiKTtcclxuaW1wb3J0IGhidWlsZCA9IHJlcXVpcmUoXCJka21saWIvZ2VuZXJpYy9oYnVpbGRcIik7XHJcblxyXG5cclxuZnVuY3Rpb24gY2J4VGVzdCgpIHtcclxuICAgIHZhciBkYXRhID0gW1xyXG4gICAgICAgIHtucjpcIjFcIiwgbW5hbWU6XCJNaWNoYWVsXCJ9LFxyXG4gICAgICAgIHtucjpcIjJcIiwgbW5hbWU6XCJNb25pa2FcIn0sXHJcbiAgICAgICAge25yOlwiM1wiLCBtbmFtZTpcIkFubmFcIn0sXHJcbiAgICBdO1xyXG5cclxuICAgIHZhciBzYjpoYnVpbGQuVFN0cmluZ0J1aWxkZXIgPSBuZXcgaGJ1aWxkLlRTdHJpbmdCdWlsZGVyKCk7XHJcblxyXG4gICAgc2VsZWN0QnVpbGQuY3JlYXRlU2VsZWN0KHtcclxuICAgICAgICBkYXRhOiBkYXRhLFxyXG4gICAgICAgIHZhbHVlRmllbGQ6IFwibnJcIixcclxuICAgICAgICBkaXNwbGF5RmllbGQ6IFwibW5hbWVcIixcclxuICAgICAgIC8qIGZpcnN0Um93cz86IElTZWxlY3RPcHQ7XHJcbiAgICBhdHRycz86IGhidWlsZC5JQXR0cmlidXRlW107Ki9cclxuICAgICAgICBzZWxlY3RlZFZhbDogXCIxXCIsXHJcbiAgICAgICAgc2I6IHNiXHJcbiAgICB9KTtcclxuICAgIHZhciBodG1sID0gc2IudG9TdHJpbmcoKTtcclxuICAgIHdpbmRvdy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNlbGVjdFJlc3VsdFwiKS5pbm5lckhUTUwgPSBodG1sO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc3RhcnQoKSB7XHJcbiAgICAkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcclxuICAgICAgIGNieFRlc3QoKTtcclxuICAgIH0pO1xyXG59Il19
